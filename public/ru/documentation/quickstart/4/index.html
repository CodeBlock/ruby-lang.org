
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Ruby Programming Language – Ruby за двадцать минут (4/4)</title>
  <meta name="author" content="Ruby Community">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- meta -->
  

  <!-- scripts -->
  <link rel="canonical" href="http://www.ruby-lang.org/ru/documentation/quickstart/4/index.html"/>
  <link href="/favicon.ico" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://s3.amazonaws.com/ender-js/jeesh.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <link href="/atom.xml" rel="alternate" title="Ruby Programming Language" type="application/atom+xml"/>
  

  
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

</head>

<body  >
  <div id="fixed-nav">
    <nav role=navigation>


<a class="to-home" href="/ru"><img class="logo" src="/images/ruby.png" /></a>
<ul role=main-navigation>
  
</ul>

</nav>
  </div>
  <header><hgroup>
  <div id="langs">
    
    <a href="/en/documentation/quickstart/4/index.html">en</a>
    
    <a href="/es/documentation/quickstart/4/index.html">es</a>
    
    <a href="/fr/documentation/quickstart/4/index.html">fr</a>
    
  </div>
  <a href="/ru"></a>
</hgroup>

</header>
  <div id="main">
    <div id="content">
      <div>
<article>
  <header>
    <h1 class="entry-title">Ruby за двадцать минут (4/4)</h1>
  </header>
  <p>И так, разглядывая детально нашу новую программу, включая первоначальную строку, которая начинается
со знака диез <code>#</code>. В Ruby, любая строка которая находится после символа диез, комментарий который
игнорируется интерпретатором. Первая строка файла специальное значение, для семейства операционных систем Unix, передает оболочке как выполнить файл. Остальная часть комментариев здесь просто для пояснения.</p>

<p>Наш <code>say_hi</code> немного усложнился:</p>

<div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
<span class='line'>10</span>
<span class='line'>11</span>
<span class='line'>12</span>
<span class='line'>13</span>
</pre></td><td class='code' width='100%'><pre><code class='ruby'><div class='line'><span class="c1"># Say hi to everybody</span>
</div><div class='line'><span class="k">def</span> <span class="nf">say_hi</span>
</div><div class='line'>  <span class="k">if</span> <span class="vi">@names</span><span class="o">.</span><span class="n">nil?</span>
</div><div class='line'>    <span class="nb">puts</span> <span class="s2">&quot;...&quot;</span>
</div><div class='line'>  <span class="k">elsif</span> <span class="vi">@names</span><span class="o">.</span><span class="n">respond_to?</span><span class="p">(</span><span class="s2">&quot;each&quot;</span><span class="p">)</span>
</div><div class='line'>    <span class="c1"># @names is a list of some kind, iterate!</span>
</div><div class='line'>    <span class="vi">@names</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="o">|</span>
</div><div class='line'>      <span class="nb">puts</span> <span class="s2">&quot;Hello </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">!&quot;</span>
</div><div class='line'>    <span class="k">end</span>
</div><div class='line'>  <span class="k">else</span>
</div><div class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Hello </span><span class="si">#{</span><span class="vi">@names</span><span class="si">}</span><span class="s2">!&quot;</span>
</div><div class='line'>  <span class="k">end</span>
</div><div class='line'><span class="k">end</span>
</div></code></pre></td></tr></table></div>

<p>Теперь он просматривает <code>@name</code> экземпляр переменной для того чтобы принять решение. Если он <code>nil</code>,
он просто выведет три точки. Нет смысла приветствовать никого, правда же?</p>

<h2>Циклы и повторы, – Итерации</h2>

<p>Если <code>@names</code> объект отвечает на вызов <code>each</code>, это значит, что вы можете итерировать его, – перебирать и здороваться с
каждым человеком.
И наконец, если <code>@names</code> что-то еще, мы преобразуем его в <code>string</code> автоматически и отприветствуем его классическим для нас способом.</p>

<p>Давайте рассмотрим этот итератор немного ближе:</p>

<div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
</pre></td><td class='code' width='100%'><pre><code class='ruby'><div class='line'><span class="vi">@names</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="o">|</span>
</div><div class='line'>  <span class="nb">puts</span> <span class="s2">&quot;Hello </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">!&quot;</span>
</div><div class='line'><span class="k">end</span>
</div></code></pre></td></tr></table></div>

<p><code>each</code> это метод, который принимает блок кода между <code>do</code> и <code>end</code>, затем его запускает для каждого элемента в списке. Блоки это как анонимные функции или <code>lambda</code>.
Переменные между длинной чертой <code>|</code> является параметрами для блока.</p>

<p>Что же происходит здесь, для каждой записи в списке? <code>name</code> содержит элемент этого списка, а потом выражение <code>puts #{name}</code> запускается с этим именем.</p>

<p>Большинство других языков программирования проходятся по списку используя <code>for</code> для повтора, который в C смотрится
примерно так:</p>

<div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
</pre></td><td class='code' width='100%'><pre><code class='ruby'><div class='line'><span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">number_of_elements</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</div><div class='line'><span class="p">{</span>
</div><div class='line'>  <span class="n">do_something_with</span><span class="p">(</span><span class="n">element</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
</div><div class='line'><span class="p">}</span>
</div></code></pre></td></tr></table></div>

<p>Конечно это работает, но выглядит не шикарно, правда же? Вам нужна временная переменная как <code>i</code> например,
определить насколько длинный список, и объяснить как ему пройтись по нему.
Ruby намного элегантней, все эти технические детали скрыты в методе <code>each</code>, все что вам нужно сделать, это
сообщить что вы хотите сделать с элементом из списка. Внутри, метод <code>each</code>, будет по существу вызывать <code>yield "Albert"</code>, а потом <code>yield "Brenda"</code> и <code>yield "Charles"</code>, ну и так далее.</p>

<h2>Блоки, сверкающий блеск граней Ruby</h2>

<p>Настоящая сила блоков раскрывается, когда вы имеете дело с вещами, которые являются более сложными, нежели списки.
Помимо обработки внутри метода, мелких технических деталей, вы также можете манипулировать начальными и последующие действиями, а также ошибками – и все это спрятано куда подальше, от забот пользователя.</p>

<div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
<span class='line'>10</span>
<span class='line'>11</span>
</pre></td><td class='code' width='100%'><pre><code class='ruby'><div class='line'><span class="c1"># Say bye to everybody</span>
</div><div class='line'><span class="k">def</span> <span class="nf">say_bye</span>
</div><div class='line'>  <span class="k">if</span> <span class="vi">@names</span><span class="o">.</span><span class="n">nil?</span>
</div><div class='line'>    <span class="nb">puts</span> <span class="s2">&quot;...&quot;</span>
</div><div class='line'>  <span class="k">elsif</span> <span class="vi">@names</span><span class="o">.</span><span class="n">respond_to?</span><span class="p">(</span><span class="s2">&quot;join&quot;</span><span class="p">)</span>
</div><div class='line'>    <span class="c1"># Join the list elements with commas</span>
</div><div class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Goodbye </span><span class="si">#{</span><span class="vi">@names</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span><span class="si">}</span><span class="s2">.  Come back soon!&quot;</span>
</div><div class='line'>  <span class="k">else</span>
</div><div class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Goodbye </span><span class="si">#{</span><span class="vi">@names</span><span class="si">}</span><span class="s2">.  Come back soon!&quot;</span>
</div><div class='line'>  <span class="k">end</span>
</div><div class='line'><span class="k">end</span>
</div></code></pre></td></tr></table></div>

<p><code>say_bye</code> метод не использует <code>each</code>, вопреки он проверяет отвечает ли <code>@names</code> на вызов метода <code>join</code>, и если да, то использует его. В противном случае, он просто отобразит нам переменную как <code>string</code>. Этот метод не интересует, <code>type</code> переменной, он просто полагается на поддержку данных методов, действует по принципу “Утиная типизация”, звучит как “Ну если ходит как утка, и квакает как утка – определенно утка&#8230;”.
Преимущество этого, заключается в том что оно не ограничивает типы переменных которые поддерживает. Если кто-нибудь придет с новым вариантом списка класса, то пока в нем будет реализован метод <code>join</code> с такой же семантикой, все будет работать как было задумано.</p>

<h2>Отбрасываем скрипт</h2>

<p>В общем, это весь MegaGreeter класс, остальная часть файла просто вызывает методы этого класса.
Здесь есть один последний трюк, на который стоит обратить внимание, на линию:</p>

<div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class='ruby'><div class='line'><span class="k">if</span> <span class="bp">__FILE__</span> <span class="o">==</span> <span class="vg">$0</span>
</div></code></pre></td></tr></table></div>

<p><code>__FILE__</code> магическая переменная которая содержит в себе имя данного файла. <code>$0</code> имя файла которое используется для запуска программы. Таким образом, мы проверяем “Если используется один и тот же файл&#8230;” Это позволяет файл использовать как библиотеку, и не интерпретировать код который находится внутри, но если файл используется как исполняемый, тогда выполнить код.</p>

<h2>Считайте себя ознакомленным</h2>

<p>Пожалуй, этого достаточно для быстрого введения в Ruby. Ещё много чего можно исследовать дальше, различные управляющие конструкции, имеющиеся в Ruby; использование блоков и метода yield; модули в роли примесей и многое другое. Надеюсь, немного распробовав Ruby, вы захотите изучить больше.</p>

<p>Если так, прошу направиться в наш раздел Документация, который охватывает много ссылок на руководства и учебники, свободно доступных в Сети.</p>

<p>Или же, если вам действительно захотелось углубиться в какую-нибудь книгу, обратитесь к списку книг в поисках изданий, которые продаются через Сеть или в ближайшем книжном магазине.</p>

  
</article>

</div>

<aside role=sidebar>
  
    



<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
  </ul>
</section>




  
</aside>


    </div>
  </div>
  <footer>


<nav role=navigation>


<a class="to-home" href="/ru"><img class="logo" src="/images/ruby.png" /></a>
<ul role=main-navigation>
  
</ul>

</nav>
<a href="/ru/credits"></a>

</footer>
</body>
</html>
